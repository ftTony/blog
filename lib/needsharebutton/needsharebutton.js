(function(){function e(e,o){if(typeof o=="string"){var t=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector;if(!!t){while(e){if(t.bind(e)(o)){return e}else{e=e.parentElement}}}return false}else{while(e){if(e==o){return e}else{e=e.parentElement}}return false}}window.needShareButton=function(o,t){var n=this;n.elem=o||"need-share-button";n.getTitle=function(){var e;if(document.querySelector){e=document.querySelector("title");if(e){return e.innerText}}return document.title};n.getImage=function(){var e;if(document.querySelector){e=document.querySelector('meta[property="og:image"]')||document.querySelector('meta[name="twitter:image"]');if(e){return e.getAttribute("content")}else{return""}}else{return""}};n.getDescription=function(){var e;if(document.querySelector){e=document.querySelector('meta[property="og:description"]')||document.querySelector('meta[name="twitter:description"]')||document.querySelector('meta[name="description"]');if(e){return e.getAttribute("content")}else{return""}}else{e=document.getElementsByTagName("meta").namedItem("description");if(e){return e.getAttribute("content")}else{return""}}};n.share={weibo:function(e){var o=i(e);var t="http://v.t.sina.com.cn/share/share.php?title="+encodeURIComponent(o.title)+"&url="+encodeURIComponent(o.url)+"&pic="+encodeURIComponent(o.image);n.popup(t)},wechat:function(e){var o=i(e);var t="https://api.qinco.me/api/qr?size=400&content="+encodeURIComponent(o.url);var n=e.querySelector(".need-share-button_dropdown");var r=n.getElementsByClassName("need-share-wechat-code-image")[0];if(r){r.remove()}else{r=document.createElement("img");r.src=t;r.alt="loading wechat image...";r.setAttribute("class","need-share-wechat-code-image");n.appendChild(r)}},douban:function(e){var o=i(e);var t="https://www.douban.com/share/service?name="+encodeURIComponent(o.title)+"&href="+encodeURIComponent(o.url)+"&image="+encodeURIComponent(o.image);n.popup(t)},qqzone:function(e){var o=i(e);var t="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?title="+encodeURIComponent(o.title)+"&url="+encodeURIComponent(o.url)+"&pics="+encodeURIComponent(o.image)+"&desc="+encodeURIComponent(o.description);n.popup(t)},renren:function(e){var o=i(e);var t="http://widget.renren.com/dialog/share?title="+encodeURIComponent(o.title)+"&resourceUrl="+encodeURIComponent(o.url)+"&pic="+encodeURIComponent(o.image)+"&description="+encodeURIComponent(o.description);n.popup(t)},mailto:function(e){var o=i(e);var t="mailto:?subject="+encodeURIComponent(o.title)+"&body=Thought you might enjoy reading this: "+encodeURIComponent(o.url)+" - "+encodeURIComponent(o.description);window.location.href=t},twitter:function(e){var o=i(e);var t=o.protocol+"twitter.com/intent/tweet?text=";t+=encodeURIComponent(o.title)+"&url="+encodeURIComponent(o.url);n.popup(t)},pinterest:function(e){var o=i(e);var t=o.protocol+"pinterest.com/pin/create/bookmarklet/?is_video=false";t+="&media="+encodeURIComponent(o.image);t+="&url="+encodeURIComponent(o.url);t+="&description="+encodeURIComponent(o.title);n.popup(t)},facebook:function(e){var o=i(e);var t=o.protocol+"www.facebook.com/share.php?";t+="u="+encodeURIComponent(o.url);t+="&title="+encodeURIComponent(o.title);n.popup(t)},googleplus:function(e){var o=i(e);var t=o.protocol+"plus.google.com/share?";t+="url="+encodeURIComponent(o.url);n.popup(t)},reddit:function(e){var o=i(e);var t=o.protocol+"www.reddit.com/submit?";t+="url="+encodeURIComponent(o.url);t+="&title="+encodeURIComponent(o.title);n.popup(t)},delicious:function(e){var o=i(e);var t=o.protocol+"del.icio.us/post?";t+="url="+encodeURIComponent(o.url);t+="&title="+encodeURIComponent(o.title);t+="&notes="+encodeURIComponent(o.description);n.popup(t)},stumbleupon:function(e){var o=i(e);var t=o.protocol+"www.stumbleupon.com/submit?";t+="url="+encodeURIComponent(o.url);t+="&title="+encodeURIComponent(o.title);n.popup(t)},linkedin:function(e){var o=i(e);var t=o.protocol+"www.linkedin.com/shareArticle?mini=true";t+="&url="+encodeURIComponent(o.url);t+="&title="+encodeURIComponent(o.title);t+="&source="+encodeURIComponent(o.source);n.popup(t)},slashdot:function(e){var o=i(e);var t=o.protocol+"slashdot.org/bookmark.pl?";t+="url="+encodeURIComponent(o.url);t+="&title="+encodeURIComponent(o.title);n.popup(t)},technorati:function(e){var o=i(e);var t=o.protocol+"technorati.com/faves?";t+="add="+encodeURIComponent(o.url);t+="&title="+encodeURIComponent(o.title);n.popup(t)},posterous:function(e){var o=i(e);var t=o.protocol+"posterous.com/share?";t+="linkto="+encodeURIComponent(o.url);n.popup(t)},tumblr:function(e){var o=i(e);var t=o.protocol+"www.tumblr.com/share?v=3";t+="&u="+encodeURIComponent(o.url);t+="&t="+encodeURIComponent(o.title);n.popup(t)},googlebookmarks:function(e){var o=i(e);var t=o.protocol+"www.google.com/bookmarks/mark?op=edit";t+="&bkmk="+encodeURIComponent(o.url);t+="&title="+encodeURIComponent(o.title);t+="&annotation="+encodeURIComponent(o.description);n.popup(t)},newsvine:function(e){var o=i(e);var t=o.protocol+"www.newsvine.com/_tools/seed&save?";t+="u="+encodeURIComponent(o.url);t+="&h="+encodeURIComponent(o.title);n.popup(t)},evernote:function(e){var o=i(e);var t=o.protocol+"www.evernote.com/clip.action?";t+="url="+encodeURIComponent(o.url);t+="&title="+encodeURIComponent(o.title);n.popup(t)},friendfeed:function(e){var o=i(e);var t=o.protocol+"www.friendfeed.com/share?";t+="url="+encodeURIComponent(o.url);t+="&title="+encodeURIComponent(o.title);n.popup(t)},vkontakte:function(e){var o=i(e);var t=o.protocol+"vkontakte.ru/share.php?";t+="url="+encodeURIComponent(o.url);t+="&title="+encodeURIComponent(o.title);t+="&description="+encodeURIComponent(o.description);t+="&image="+encodeURIComponent(o.image);t+="&noparse=true";n.popup(t)},odnoklassniki:function(e){var o=i(e);var t=o.protocol+"www.odnoklassniki.ru/dk?st.cmd=addShare&st.s=1";t+="&st.comments="+encodeURIComponent(o.description);t+="&st._surl="+encodeURIComponent(o.url);n.popup(t)},mailru:function(e){var o=i(e);var t=o.protocol+"connect.mail.ru/share?";t+="url="+encodeURIComponent(o.url);t+="&title="+encodeURIComponent(o.title);t+="&description="+encodeURIComponent(o.description);t+="&imageurl="+encodeURIComponent(o.image);n.popup(t)}};n.popup=function(e){var o=600,t=500,n=window.screenLeft!==undefined?window.screenLeft:screen.left,r=window.screenTop!==undefined?window.screenTop:screen.top,i=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,a=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,c=i/2-o/2+n,s=a/2-t/2+r,p=window.open(e,"targetWindow","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width="+o+", height="+t+", top="+s+", left="+c);if(window.focus){p.focus()}};n.options={iconStyle:"default",boxForm:"horizontal",position:"bottomCenter",protocol:["http","https"].indexOf(window.location.href.split(":")[0])===-1?"https://":"//",networks:"Weibo,Wechat,Douban,QQZone,Twitter,Pinterest,Facebook,GooglePlus,Reddit,Linkedin,Tumblr,Evernote"};for(var r in t){if(t.hasOwnProperty(r)){n.options[r]=t[r]}}n.options.networks=n.options.networks.split(",");function i(e){var o={};for(var t in n.options){if(n.options.hasOwnProperty(t)){o[t]=n.options[t]}}o.url=window.location.href;o.title=n.getTitle();o.image=n.getImage();o.description=n.getDescription();for(var r in e.dataset){if(r.match(/share/)){var i=r.replace(/share/,"");if(!i.length){continue}i=i.charAt(0).toLowerCase()+i.slice(1);var a=e.dataset[r];if(i==="networks"){a=a.split(",")}else if(i==="url"&&a&&a[0]==="/"){a=location.origin+a}o[i]=a}}return o}function a(o){var t=document.createElement("span");t.className="need-share-button_dropdown";if(o.querySelector(".need-share-button_dropdown")){return}var r=i(o);if(r.iconStyle=="box"&&r.boxForm=="horizontal"){t.className+=" need-share-button_dropdown-box-horizontal"}else if(r.iconStyle=="box"&&r.boxForm=="vertical"){t.className+=" need-share-button_dropdown-box-vertical"}setTimeout(function(){switch(r.position){case"topLeft":t.className+=" need-share-button_dropdown-top-left";break;case"topRight":t.className+=" need-share-button_dropdown-top-right";break;case"topCenter":t.className+=" need-share-button_dropdown-top-center";t.style.marginLeft=-t.offsetWidth/2+"px";break;case"middleLeft":t.className+=" need-share-button_dropdown-middle-left";t.style.marginTop=-t.offsetHeight/2+"px";break;case"middleRight":t.className+=" need-share-button_dropdown-middle-right";t.style.marginTop=-t.offsetHeight/2+"px";break;case"bottomLeft":t.className+=" need-share-button_dropdown-bottom-left";break;case"bottomRight":t.className+=" need-share-button_dropdown-bottom-right";break;case"bottomCenter":t.className+=" need-share-button_dropdown-bottom-center";t.style.marginLeft=-t.offsetWidth/2+"px";break;default:t.className+=" need-share-button_dropdown-bottom-center";t.style.marginLeft=-t.offsetWidth/2+"px";break}},1);var a=r.iconStyle=="default"?"need-share-button_link need-share-button_":"need-share-button_link-"+r.iconStyle+" need-share-button_link need-share-button_";for(var c in r.networks){if(r.networks.hasOwnProperty(c)){var s=document.createElement("span");c=r.networks[c].trim();var p=c.toLowerCase();s.className=a+p;var d=["weibo","wechat","douban","qqzone","renren"];if(d.indexOf(p)===-1){s.className+=" social-"+p}else{s.className+=" icon-"+p}s.dataset.network=p;s.title=c;t.appendChild(s)}}t.addEventListener("click",function(t){if(e(t.target,".need-share-button_link")){t.preventDefault();t.stopPropagation();n.share[t.target.dataset.network](o);return false}});o.appendChild(t)}document.addEventListener("click",function(o){var t=document.querySelector(".need-share-button-opened");if(!e(o.target,".need-share-button-opened")){if(t){t.classList.remove("need-share-button-opened");if(t.querySelector(".need-share-wechat-code-image")){t.querySelector(".need-share-wechat-code-image").remove()}}else{var r=e(o.target,n.elem);if(r){if(!r.classList.contains("need-share-button-opened")){a(r);setTimeout(function(){r.classList.add("need-share-button-opened")},1)}}}}else{setTimeout(function(){t.classList.remove("need-share-button-opened");if(t.querySelector(".need-share-wechat-code-image")){t.querySelector(".need-share-wechat-code-image").remove()}},1)}})}})();